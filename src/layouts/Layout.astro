---
import '../styles/global.css';

interface Props {
  title: string;
  description: string;
}

const { title, description = "Музыкант, мультиинструменталист, вокалист в стиле дхрупад, композитор, преподаватель. Синтез западной и индийской классической музыки." } = Astro.props;

const navLinks = [
    { name: "Обо мне", href: "/#about" },
    { name: "Проекты", href: "/#projects" },
    { name: "Деятельность", href: "/#services" },
    { name: "Контакт", href: "/#contact" },
];
---

<!doctype html>
<html lang="ru" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=Montserrat:wght@200;300;400;500&display=swap" rel="stylesheet">

    <title>{title}</title>
  </head>
  <body class="bg-slate-900 text-slate-100 font-sans antialiased selection:bg-amber-700 selection:text-white overflow-x-hidden">

        <nav class="fixed w-full z-50 bg-slate-900/90 backdrop-blur-md border-b border-white/5">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-20">

                    <a href="#" class="relative z-50 text-2xl font-serif tracking-widest text-amber-500 hover:text-amber-400 transition">
                        АНДРЕЙ ДЕМИДЕНКО
                    </a>

                    <div class="hidden md:flex space-x-8 text-xs uppercase tracking-[0.2em] text-slate-300">
                        {navLinks.map(link => (
                            <a href={link.href} class="hover:text-amber-500 transition-colors duration-300 relative group">
                                {link.name}
                                <span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-amber-500 transition-all duration-300 group-hover:w-full"></span>
                            </a>
                        ))}
                    </div>

                    <button id="menu-btn" aria-label="Menu" class="md:hidden relative z-50 w-10 h-10 flex flex-col justify-center items-end space-y-1.5 focus:outline-none group">
                        <span class="line-1 block w-8 h-[2px] bg-amber-500 transition-transform duration-300 origin-right group-hover:w-6"></span>
                        <span class="line-2 block w-6 h-[2px] bg-slate-300 transition-opacity duration-300"></span>
                        <span class="line-3 block w-8 h-[2px] bg-amber-500 transition-transform duration-300 origin-right group-hover:w-6"></span>
                    </button>
                </div>
            </div>
        </nav>

        <div id="mobile-menu" class="fixed inset-0 z-40 bg-slate-950/98 backdrop-blur-xl flex flex-col justify-start pt-32 items-center overflow-y-auto invisible opacity-0 translate-x-full transition-all duration-500">

            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] h-[300px] bg-amber-500/10 rounded-full blur-[100px] pointer-events-none"></div>

            <div class="flex flex-col space-y-8 text-center relative z-10 w-full px-4">
                {navLinks.map((link) => (
                    <a 
                        href={link.href} 
                        class="mobile-link text-3xl font-serif italic text-slate-300 hover:text-amber-500 transition-colors duration-300 transform translate-y-4 opacity-0 py-2 block w-full"
                    >
                        {link.name}
                    </a>
                ))}
            </div>

            <div class="mt-auto mb-10 text-slate-600 text-xs uppercase tracking-widest relative z-10">
                www.demidenko.info
            </div>
        </div>

    <slot />

        <script is:inline>
            // is:inline гарантирует, что скрипт выполнится сразу и не будет "оптимизирован" Astro до поломки
            const menuBtn = document.getElementById('menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileLinks = document.querySelectorAll('.mobile-link');

            // Находим полоски гамбургера для анимации
            const line1 = document.querySelector('.line-1');
            const line2 = document.querySelector('.line-2');
            const line3 = document.querySelector('.line-3');

            let isMenuOpen = false;

            function toggleMenu() {
                isMenuOpen = !isMenuOpen;

                if (isMenuOpen) {
                    // ОТКРЫТИЕ
                    document.body.style.overflow = 'hidden'; // Блокируем скролл сайта

                    // Показываем меню (удаляем скрывающие классы)
                    mobileMenu.classList.remove('invisible', 'opacity-0', 'translate-x-full');

                    // Анимация крестика
                    line1.style.transform = 'rotate(-45deg) translate(-2px, 2px)';
                    line1.style.backgroundColor = '#fff';
                    line2.style.opacity = '0';
                    line3.style.transform = 'rotate(45deg) translate(-2px, -2px)';
                    line3.style.backgroundColor = '#fff';

                    // Каскадная анимация появления ссылок
                    mobileLinks.forEach((link, index) => {
                        setTimeout(() => {
                            link.classList.remove('translate-y-4', 'opacity-0');
                        }, index * 100 + 100); // Небольшая задержка
                    });

                } else {
                    // ЗАКРЫТИЕ
                    document.body.style.overflow = '';

                    // Скрываем меню
                    mobileMenu.classList.add('invisible', 'opacity-0', 'translate-x-full');

                    // Возвращаем гамбургер
                    line1.style.transform = 'none';
                    line1.style.backgroundColor = '';
                    line2.style.opacity = '1';
                    line3.style.transform = 'none';
                    line3.style.backgroundColor = '';

                    // Сбрасываем ссылки
                    mobileLinks.forEach(link => {
                        link.classList.add('translate-y-4', 'opacity-0');
                    });
                }
            }

            // Слушатель клика по кнопке
            if (menuBtn) {
                menuBtn.addEventListener('click', toggleMenu);
            }

            // Слушатель клика по ссылкам (чтобы меню закрывалось при переходе)
            mobileLinks.forEach(link => {
                link.addEventListener('click', toggleMenu);
            });
        </script>
  </body>
</html>

<style is:global>
  :root {
    --font-serif: 'Cormorant Garamond', serif;
    --font-sans: 'Montserrat', sans-serif;
  }
    h1, h2, h3, h4, h5, h6 {
        font-family: var(--font-serif);
    }
    body {
        font-family: var(--font-sans);
    }
</style>
